
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{presentation}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \hypertarget{mask-r-cnn-demo}{%
\section{Mask R-CNN Demo}\label{mask-r-cnn-demo}}

    \hypertarget{environment-setup}{%
\subsubsection{Environment Setup}\label{environment-setup}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{k+kn}{import} \PY{n+nn}{os}
         \PY{k+kn}{import} \PY{n+nn}{sys}
         \PY{k+kn}{import} \PY{n+nn}{random}
         \PY{k+kn}{import} \PY{n+nn}{math}
         \PY{k+kn}{import} \PY{n+nn}{re}
         \PY{k+kn}{import} \PY{n+nn}{time}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
         \PY{k+kn}{import} \PY{n+nn}{tensorflow} \PY{k}{as} \PY{n+nn}{tf}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{patches} \PY{k}{as} \PY{n+nn}{patches}
         \PY{k+kn}{import} \PY{n+nn}{imgaug}
         \PY{k+kn}{from} \PY{n+nn}{imgaug} \PY{k}{import} \PY{n}{augmenters} \PY{k}{as} \PY{n}{iaa}
         
         \PY{c+c1}{\PYZsh{} Root directory of the project}
         \PY{n}{ROOT\PYZus{}DIR} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{abspath}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{../../}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Import Mask RCNN}
         \PY{n}{sys}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{ROOT\PYZus{}DIR}\PY{p}{)}  \PY{c+c1}{\PYZsh{} To find local version of the library}
         \PY{k+kn}{from} \PY{n+nn}{mrcnn} \PY{k}{import} \PY{n}{utils}
         \PY{k+kn}{from} \PY{n+nn}{mrcnn} \PY{k}{import} \PY{n}{visualize}
         \PY{k+kn}{from} \PY{n+nn}{mrcnn}\PY{n+nn}{.}\PY{n+nn}{visualize} \PY{k}{import} \PY{n}{display\PYZus{}images}
         \PY{k+kn}{import} \PY{n+nn}{mrcnn}\PY{n+nn}{.}\PY{n+nn}{model} \PY{k}{as} \PY{n+nn}{modellib}
         \PY{k+kn}{from} \PY{n+nn}{mrcnn}\PY{n+nn}{.}\PY{n+nn}{model} \PY{k}{import} \PY{n}{log}
         
         \PY{k+kn}{from} \PY{n+nn}{samples}\PY{n+nn}{.}\PY{n+nn}{whales} \PY{k}{import} \PY{n}{whale}
         
         \PY{k+kn}{import} \PY{n+nn}{numpy}\PY{n+nn}{.}\PY{n+nn}{ma} \PY{k}{as} \PY{n+nn}{ma}
         \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{misc}
         
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{k+kn}{import} \PY{n+nn}{skimage}\PY{n+nn}{.}\PY{n+nn}{filters}
         
         \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline 
         
         \PY{c+c1}{\PYZsh{} Directory to save logs and trained model}
         \PY{n}{MODEL\PYZus{}DIR} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{ROOT\PYZus{}DIR}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{logs}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \hypertarget{model-and-dataset-setup}{%
\subsubsection{Model and dataset setup}\label{model-and-dataset-setup}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{c+c1}{\PYZsh{}sets up the system and generates masks}
         \PY{c+c1}{\PYZsh{} Root directory of the project}
         \PY{n}{ROOT\PYZus{}DIR} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{abspath}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{../../}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Import Mask RCNN}
         \PY{n}{sys}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{ROOT\PYZus{}DIR}\PY{p}{)}  \PY{c+c1}{\PYZsh{} To find local version of the library}
         \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline 
         
         \PY{c+c1}{\PYZsh{} Path to trained weights}
         \PY{c+c1}{\PYZsh{}WHALE\PYZus{}WEIGHTS\PYZus{}PATH = \PYZdq{}/home/clifgray/Code/Mask\PYZus{}RCNN/logs/whale20180613T0247/mask\PYZus{}rcnn\PYZus{}whale\PYZus{}0075.h5\PYZdq{}}
         
         \PY{n}{config} \PY{o}{=} \PY{n}{whale}\PY{o}{.}\PY{n}{WhaleConfig}\PY{p}{(}\PY{p}{)}
         \PY{n}{WHALE\PYZus{}DIR} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{ROOT\PYZus{}DIR}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{datasets/whale\PYZus{}training/blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Override the training configurations with a few}
         \PY{c+c1}{\PYZsh{} changes for inferencing.}
         \PY{k}{class} \PY{n+nc}{InferenceConfig}\PY{p}{(}\PY{n}{config}\PY{o}{.}\PY{n+nv+vm}{\PYZus{}\PYZus{}class\PYZus{}\PYZus{}}\PY{p}{)}\PY{p}{:}
         \PY{c+c1}{\PYZsh{} Run detection on one image at a time}
             \PY{n}{GPU\PYZus{}COUNT} \PY{o}{=} \PY{l+m+mi}{1}
             \PY{n}{IMAGES\PYZus{}PER\PYZus{}GPU} \PY{o}{=} \PY{l+m+mi}{1}
         
         \PY{n}{config} \PY{o}{=} \PY{n}{InferenceConfig}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}config.display()}
         
         \PY{c+c1}{\PYZsh{} Device to load the neural network on.}
         \PY{c+c1}{\PYZsh{} Useful if you\PYZsq{}re training a model on the same }
         \PY{c+c1}{\PYZsh{} machine, in which case use CPU and leave the}
         \PY{c+c1}{\PYZsh{} GPU for training.}
         \PY{n}{DEVICE} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/gpu:0}\PY{l+s+s2}{\PYZdq{}}  \PY{c+c1}{\PYZsh{} /cpu:0 or /gpu:0}
         
         \PY{c+c1}{\PYZsh{} Inspect the model in training or inference modes}
         \PY{c+c1}{\PYZsh{} values: \PYZsq{}inference\PYZsq{} or \PYZsq{}training\PYZsq{}}
         \PY{c+c1}{\PYZsh{} TODO: code for \PYZsq{}training\PYZsq{} test mode not ready yet}
         \PY{n}{TEST\PYZus{}MODE} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{inference}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{c+c1}{\PYZsh{} Load validation dataset}
         \PY{n}{dataset} \PY{o}{=} \PY{n}{whale}\PY{o}{.}\PY{n}{WhaleDataset}\PY{p}{(}\PY{p}{)}
         \PY{n}{dataset}\PY{o}{.}\PY{n}{load\PYZus{}whale}\PY{p}{(}\PY{n}{WHALE\PYZus{}DIR}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{test}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Must call before using the dataset}
         \PY{n}{dataset}\PY{o}{.}\PY{n}{prepare}\PY{p}{(}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Images: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Classes: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{dataset}\PY{o}{.}\PY{n}{image\PYZus{}ids}\PY{p}{)}\PY{p}{,} \PY{n}{dataset}\PY{o}{.}\PY{n}{class\PYZus{}names}\PY{p}{)}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{}Getting manually drawn masks}
         \PY{n}{id\PYZus{}array} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{dataset}\PY{o}{.}\PY{n}{image\PYZus{}ids}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}17 images in this set}
         \PY{n}{mask\PYZus{}array} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{num} \PY{o+ow}{in} \PY{n}{id\PYZus{}array}\PY{p}{:}
             \PY{n}{image\PYZus{}id} \PY{o}{=} \PY{n}{num}
         
             \PY{n}{image}\PY{p}{,} \PY{n}{image\PYZus{}meta}\PY{p}{,} \PY{n}{class\PYZus{}ids}\PY{p}{,} \PY{n}{bbox}\PY{p}{,} \PY{n}{mask} \PY{o}{=} \PY{n}{modellib}\PY{o}{.}\PY{n}{load\PYZus{}image\PYZus{}gt}\PY{p}{(}\PY{n}{dataset}\PY{p}{,} \PY{n}{config}\PY{p}{,} \PY{n}{image\PYZus{}id}\PY{p}{,} \PY{n}{use\PYZus{}mini\PYZus{}mask}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
             \PY{n}{info} \PY{o}{=} \PY{n}{dataset}\PY{o}{.}\PY{n}{image\PYZus{}info}\PY{p}{[}\PY{n}{image\PYZus{}id}\PY{p}{]}
            \PY{c+c1}{\PYZsh{} if image\PYZus{}id \PYZgt{}= 19 and image\PYZus{}id \PYZlt{}= 35:}
             \PY{n}{mask\PYZus{}array}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{mask}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Images: 17
Classes: ['BG', 'Balaenoptera\_musculus\_body', 'Balaenoptera\_musculus\_pectoral']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{k}{def} \PY{n+nf}{get\PYZus{}ax}\PY{p}{(}\PY{n}{rows}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cols}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Return a Matplotlib Axes array to be used in}
         \PY{l+s+sd}{    all visualizations in the notebook. Provide a}
         \PY{l+s+sd}{    central point to control graph sizes.}
         \PY{l+s+sd}{    }
         \PY{l+s+sd}{    Adjust the size attribute to control how big to render images}
         \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
             \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{rows}\PY{p}{,} \PY{n}{cols}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{n}{size}\PY{o}{*}\PY{n}{cols}\PY{p}{,} \PY{n}{size}\PY{o}{*}\PY{n}{rows}\PY{p}{)}\PY{p}{)}
             \PY{k}{return} \PY{n}{ax}
\end{Verbatim}


    \hypertarget{function-for-whale-masking}{%
\subsubsection{Function for Whale
Masking}\label{function-for-whale-masking}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{k}{def} \PY{n+nf}{run\PYZus{}cnn}\PY{p}{(}\PY{n}{weights\PYZus{}path}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/clifgray/Code/Mask\PYZus{}RCNN/logs/whale20180613T0247/mask\PYZus{}rcnn\PYZus{}whale\PYZus{}0150.h5}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} Create model in inference mode}
             \PY{k}{with} \PY{n}{tf}\PY{o}{.}\PY{n}{device}\PY{p}{(}\PY{n}{DEVICE}\PY{p}{)}\PY{p}{:}
                 \PY{n}{model} \PY{o}{=} \PY{n}{modellib}\PY{o}{.}\PY{n}{MaskRCNN}\PY{p}{(}\PY{n}{mode}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{inference}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{model\PYZus{}dir}\PY{o}{=}\PY{n}{MODEL\PYZus{}DIR}\PY{p}{,}
                                       \PY{n}{config}\PY{o}{=}\PY{n}{config}\PY{p}{)}
                 
             \PY{c+c1}{\PYZsh{} Load weights}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Loading weights }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{weights\PYZus{}path}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{load\PYZus{}weights}\PY{p}{(}\PY{n}{weights\PYZus{}path}\PY{p}{,} \PY{n}{by\PYZus{}name}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Weights loaded.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             
             
             \PY{n}{detection\PYZus{}results} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{initial\PYZus{}time} \PY{o}{=} \PY{n}{time}\PY{o}{.}\PY{n}{perf\PYZus{}counter}\PY{p}{(}\PY{p}{)}
             \PY{k}{for} \PY{n}{image\PYZus{}id} \PY{o+ow}{in} \PY{n}{dataset}\PY{o}{.}\PY{n}{image\PYZus{}ids}\PY{p}{:}
             
                 \PY{n}{image}\PY{p}{,} \PY{n}{image\PYZus{}meta}\PY{p}{,} \PY{n}{gt\PYZus{}class\PYZus{}id}\PY{p}{,} \PY{n}{gt\PYZus{}bbox}\PY{p}{,} \PY{n}{gt\PYZus{}mask} \PY{o}{=}\PYZbs{}
                     \PY{n}{modellib}\PY{o}{.}\PY{n}{load\PYZus{}image\PYZus{}gt}\PY{p}{(}\PY{n}{dataset}\PY{p}{,} \PY{n}{config}\PY{p}{,} \PY{n}{image\PYZus{}id}\PY{p}{,} \PY{n}{use\PYZus{}mini\PYZus{}mask}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         
                 \PY{n}{info} \PY{o}{=} \PY{n}{dataset}\PY{o}{.}\PY{n}{image\PYZus{}info}\PY{p}{[}\PY{n}{image\PYZus{}id}\PY{p}{]}
         
                 \PY{c+c1}{\PYZsh{} Run object detection}
                 \PY{n}{results} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{detect}\PY{p}{(}\PY{p}{[}\PY{n}{image}\PY{p}{]}\PY{p}{,} \PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                 
                 \PY{n}{detection\PYZus{}results}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{results}\PY{p}{,} \PY{n}{info}\PY{p}{,} \PY{n}{image\PYZus{}id}\PY{p}{]}\PY{p}{)}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Done detecting and masking image \PYZsh{}:  }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{detection\PYZus{}results}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{finish\PYZus{}time} \PY{o}{=} \PY{n}{time}\PY{o}{.}\PY{n}{perf\PYZus{}counter}\PY{p}{(}\PY{p}{)}
             \PY{n}{time\PYZus{}elapsed} \PY{o}{=} \PY{n}{finish\PYZus{}time} \PY{o}{\PYZhy{}} \PY{n}{initial\PYZus{}time}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{time\PYZus{}elapsed}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{seconds elapsed while masking}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{detection\PYZus{}results}\PY{p}{)}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{images.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{p}{(}\PY{n}{time\PYZus{}elapsed}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{detection\PYZus{}results}\PY{p}{)}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{seconds per image.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{)}
             
             \PY{k}{return} \PY{n}{detection\PYZus{}results}
\end{Verbatim}


    \hypertarget{run-detection-and-masking}{%
\subsubsection{Run detection and
masking}\label{run-detection-and-masking}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{detection\PYZus{}results} \PY{o}{=} \PY{n}{run\PYZus{}cnn}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Loading weights  /home/clifgray/Code/Mask\_RCNN/logs/whale20180613T0247/mask\_rcnn\_whale\_0150.h5
Weights loaded.
Done detecting and masking image \#:  1
Done detecting and masking image \#:  2
Done detecting and masking image \#:  3
Done detecting and masking image \#:  4
Done detecting and masking image \#:  5
Done detecting and masking image \#:  6
Done detecting and masking image \#:  7
Done detecting and masking image \#:  8
Done detecting and masking image \#:  9
Done detecting and masking image \#:  10
Done detecting and masking image \#:  11
Done detecting and masking image \#:  12
Done detecting and masking image \#:  13
Done detecting and masking image \#:  14
Done detecting and masking image \#:  15
Done detecting and masking image \#:  16
Done detecting and masking image \#:  17


52.28878891799832 seconds elapsed while masking 17 images.
(3.0758111128234304, 'seconds per image.')

    \end{Verbatim}

    \hypertarget{look-at-an-example-mask}{%
\subsubsection{Look at an example mask}\label{look-at-an-example-mask}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{results\PYZus{}object} \PY{o}{=} \PY{n}{detection\PYZus{}results}\PY{p}{[}\PY{l+m+mi}{9}\PY{p}{]}
         \PY{n}{image\PYZus{}id} \PY{o}{=} \PY{n}{results\PYZus{}object}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}
         \PY{n}{info} \PY{o}{=} \PY{n}{results\PYZus{}object}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{image}\PY{p}{,} \PY{n}{image\PYZus{}meta}\PY{p}{,} \PY{n}{gt\PYZus{}class\PYZus{}id}\PY{p}{,} \PY{n}{gt\PYZus{}bbox}\PY{p}{,} \PY{n}{gt\PYZus{}mask} \PY{o}{=}\PYZbs{}
             \PY{n}{modellib}\PY{o}{.}\PY{n}{load\PYZus{}image\PYZus{}gt}\PY{p}{(}\PY{n}{dataset}\PY{p}{,} \PY{n}{config}\PY{p}{,} \PY{n}{image\PYZus{}id}\PY{p}{,} \PY{n}{use\PYZus{}mini\PYZus{}mask}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{image ID: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{.}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ (}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{) }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{info}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{source}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{info}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{id}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{image\PYZus{}id}\PY{p}{,} 
                                                \PY{n}{dataset}\PY{o}{.}\PY{n}{image\PYZus{}reference}\PY{p}{(}\PY{n}{image\PYZus{}id}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{results} \PY{o}{=} \PY{n}{results\PYZus{}object}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} Display results}
         \PY{n}{ax} \PY{o}{=} \PY{n}{get\PYZus{}ax}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{r} \PY{o}{=} \PY{n}{results}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{visualize}\PY{o}{.}\PY{n}{display\PYZus{}instances}\PY{p}{(}\PY{n}{image}\PY{p}{,} \PY{n}{r}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rois}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{r}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{masks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{r}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class\PYZus{}ids}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} 
                                     \PY{n}{dataset}\PY{o}{.}\PY{n}{class\PYZus{}names}\PY{p}{,} \PY{n}{r}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{scores}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{,}
                                     \PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Predictions}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{log}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{gt\PYZus{}class\PYZus{}id}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{gt\PYZus{}class\PYZus{}id}\PY{p}{)}
         \PY{n}{log}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{gt\PYZus{}bbox}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{gt\PYZus{}bbox}\PY{p}{)}
         \PY{n}{log}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{gt\PYZus{}mask}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{gt\PYZus{}mask}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
image ID: whale.DSC04110.JPG (9) /home/clifgray/Code/Mask\_RCNN/datasets/whale\_training/blue/test/DSC04110.JPG
gt\_class\_id              shape: (3,)                  min:    1.00000  max:    2.00000  int32
gt\_bbox                  shape: (3, 4)                min:  225.00000  max:  785.00000  int32
gt\_mask                  shape: (1024, 1024, 3)       min:    0.00000  max:    1.00000  bool

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{measuring-from-the-mask}{%
\section{Measuring from the Mask}\label{measuring-from-the-mask}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{c+c1}{\PYZsh{}After run through NN, each image could have multiple masks}
         \PY{k}{def} \PY{n+nf}{find\PYZus{}correct\PYZus{}mask}\PY{p}{(}\PY{n}{mask}\PY{p}{)}\PY{p}{:} 
             \PY{c+c1}{\PYZsh{}Find which mask to use \PYZhy{} one with the largest number of pixels}
             \PY{c+c1}{\PYZsh{} TODO change this to choosing the ones with the body label}
             \PY{n}{numOfMasks} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{size}\PY{p}{(}\PY{n}{mask}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
             \PY{n}{i} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{pixcount} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{pixCountArray} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{while} \PY{n}{i} \PY{o}{\PYZlt{}} \PY{n}{numOfMasks}\PY{p}{:}
                 \PY{n}{currentMask} \PY{o}{=} \PY{p}{(}\PY{n}{mask}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{p}{:}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{p}{)}
                 \PY{n}{pixcount} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{nonzero} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nonzero}\PY{p}{(}\PY{n}{currentMask}\PY{p}{)}
                 \PY{n}{it2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nditer}\PY{p}{(}\PY{n}{currentMask}\PY{p}{,} \PY{n}{flags} \PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{multi\PYZus{}index}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
                 \PY{k}{while} \PY{o+ow}{not} \PY{n}{it2}\PY{o}{.}\PY{n}{finished}\PY{p}{:}
                     \PY{k}{if} \PY{n}{it2}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{k+kc}{True}\PY{p}{:}
                         \PY{n}{pixcount} \PY{o}{=} \PY{n}{pixcount} \PY{o}{+} \PY{l+m+mi}{1}
                     \PY{n}{it2}\PY{o}{.}\PY{n}{iternext}\PY{p}{(}\PY{p}{)}
                 \PY{n}{pixCountArray}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{pixcount}\PY{p}{)}
                 \PY{n}{i} \PY{o}{=} \PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}
         
         \PY{c+c1}{\PYZsh{}Find max in pixCountArray \PYZhy{} gets the biggest mask that will be the body}
             \PY{n}{correctIndex} \PY{o}{=} \PY{n}{pixCountArray}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{pixCountArray}\PY{p}{)}\PY{p}{)}
             \PY{n}{body} \PY{o}{=} \PY{p}{(}\PY{n}{mask}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{correctIndex}\PY{p}{]}\PY{p}{)}
             \PY{k}{return} \PY{n}{body}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{k}{def} \PY{n+nf}{pca}\PY{p}{(}\PY{n}{body}\PY{p}{,} \PY{n}{boolean}\PY{p}{)}\PY{p}{:}
             \PY{n}{xy\PYZus{}array} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{c+c1}{\PYZsh{} get indexes of mask pixels}
             \PY{n}{y}\PY{p}{,} \PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{nonzero}\PY{p}{(}\PY{n}{body}\PY{p}{)}
             
         \PY{c+c1}{\PYZsh{} mean center the coords}
             \PY{n}{x} \PY{o}{=} \PY{n}{x} \PY{o}{\PYZhy{}} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{x}\PY{p}{)}
             \PY{n}{y} \PY{o}{=} \PY{n}{y} \PY{o}{\PYZhy{}} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{y}\PY{p}{)}
             \PY{n}{coords} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{vstack}\PY{p}{(}\PY{p}{[}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{]}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} build covariance matreix and eigenvectors}
             \PY{n}{cov} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{cov}\PY{p}{(}\PY{n}{coords}\PY{p}{)}
             \PY{n}{evals}\PY{p}{,} \PY{n}{evecs} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{eig}\PY{p}{(}\PY{n}{cov}\PY{p}{)}
             
         \PY{c+c1}{\PYZsh{} sort eigenvalues}
             \PY{n}{sort\PYZus{}indices} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{evals}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
             \PY{n}{x\PYZus{}v1}\PY{p}{,} \PY{n}{y\PYZus{}v1} \PY{o}{=} \PY{n}{evecs}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{sort\PYZus{}indices}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}  \PY{c+c1}{\PYZsh{} Eigenvector with largest eigenvalue}
             \PY{n}{x\PYZus{}v2}\PY{p}{,} \PY{n}{y\PYZus{}v2} \PY{o}{=} \PY{n}{evecs}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{sort\PYZus{}indices}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}
         
             
             \PY{k}{if} \PY{n}{boolean} \PY{o}{==} \PY{k+kc}{True}\PY{p}{:}
         \PY{c+c1}{\PYZsh{} plot the major and minor axis of the whale mask}
                 \PY{n}{scale} \PY{o}{=} \PY{l+m+mi}{20}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
                 \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{n}{x\PYZus{}v1}\PY{o}{*}\PY{o}{\PYZhy{}}\PY{n}{scale}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{x\PYZus{}v1}\PY{o}{*}\PY{n}{scale}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,}
                  \PY{p}{[}\PY{n}{y\PYZus{}v1}\PY{o}{*}\PY{o}{\PYZhy{}}\PY{n}{scale}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{y\PYZus{}v1}\PY{o}{*}\PY{n}{scale}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{n}{x\PYZus{}v2}\PY{o}{*}\PY{o}{\PYZhy{}}\PY{n}{scale}\PY{p}{,} \PY{n}{x\PYZus{}v2}\PY{o}{*}\PY{n}{scale}\PY{p}{]}\PY{p}{,}
                  \PY{p}{[}\PY{n}{y\PYZus{}v2}\PY{o}{*}\PY{o}{\PYZhy{}}\PY{n}{scale}\PY{p}{,} \PY{n}{y\PYZus{}v2}\PY{o}{*}\PY{n}{scale}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{equal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Match the image system with origin at top left}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} orient this along the horizontal axis}
             \PY{n}{theta} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{tanh}\PY{p}{(}\PY{p}{(}\PY{n}{x\PYZus{}v2}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{n}{y\PYZus{}v2}\PY{p}{)}\PY{p}{)}  
             \PY{n}{rotation\PYZus{}mat} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{matrix}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{theta}\PY{p}{)}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{theta}\PY{p}{)}\PY{p}{]}\PY{p}{,}
                               \PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{sin}\PY{p}{(}\PY{n}{theta}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{cos}\PY{p}{(}\PY{n}{theta}\PY{p}{)}\PY{p}{]}\PY{p}{]}\PY{p}{)}
             \PY{n}{transformed\PYZus{}mat} \PY{o}{=} \PY{n}{rotation\PYZus{}mat} \PY{o}{*} \PY{n}{coords}
         \PY{c+c1}{\PYZsh{} plot the transformed blob}
         \PY{c+c1}{\PYZsh{}these are the final transformed coords}
             \PY{n}{x\PYZus{}transformed}\PY{p}{,} \PY{n}{y\PYZus{}transformed} \PY{o}{=} \PY{n}{transformed\PYZus{}mat}\PY{o}{.}\PY{n}{A}
         
             \PY{n}{maxX} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{x\PYZus{}transformed}\PY{p}{)}
             \PY{n}{minX} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{x\PYZus{}transformed}\PY{p}{)}
             \PY{n}{maxY} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{y\PYZus{}transformed}\PY{p}{)}
             \PY{n}{minY} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{y\PYZus{}transformed}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{}Get corresonding Y values for minX and maxX}
             \PY{n}{maxX\PYZus{}index} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{x\PYZus{}transformed} \PY{o}{==} \PY{n}{maxX}\PY{p}{)} \PY{c+c1}{\PYZsh{}index of right\PYZhy{}most point}
             \PY{n}{rightY} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}transformed}\PY{p}{[}\PY{n}{maxX\PYZus{}index}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}corresponding Y value}
         
         
             \PY{n}{minX\PYZus{}index} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{x\PYZus{}transformed} \PY{o}{==} \PY{n}{minX}\PY{p}{)} \PY{c+c1}{\PYZsh{}index of left\PYZhy{}most point}
             \PY{n}{leftY} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}transformed}\PY{p}{[}\PY{n}{minX\PYZus{}index}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}corresponding Y value}
             
         \PY{c+c1}{\PYZsh{}Orient the mask correctly \PYZhy{} flip so the fluke is on the right}
         
         \PY{c+c1}{\PYZsh{}Get corresonding X values for maxY and minY}
         
             \PY{n}{maxY\PYZus{}index} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{y\PYZus{}transformed} \PY{o}{==} \PY{n}{maxY}\PY{p}{)} \PY{c+c1}{\PYZsh{}index of top point}
             \PY{n}{topX} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{p}{(}\PY{n}{x\PYZus{}transformed}\PY{p}{[}\PY{n}{maxY\PYZus{}index}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}corresponding X value}
         
         
             \PY{n}{minY\PYZus{}index} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{y\PYZus{}transformed} \PY{o}{==} \PY{n}{minY}\PY{p}{)} \PY{c+c1}{\PYZsh{}index of bottom point}
             \PY{n}{bottomX} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{p}{(}\PY{n}{x\PYZus{}transformed}\PY{p}{[}\PY{n}{minY\PYZus{}index}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}corresponding X value}
         
             \PY{c+c1}{\PYZsh{}Flip mask so fluke is on the right, if necessary}
             \PY{k}{if} \PY{p}{(}\PY{n}{topX} \PY{o}{\PYZlt{}} \PY{l+m+mi}{0} \PY{o+ow}{or} \PY{n}{bottomX} \PY{o}{\PYZlt{}} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:}
                 \PY{n}{x\PYZus{}transformed} \PY{o}{=} \PY{n}{x\PYZus{}transformed}\PY{o}{*}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1} 
             
             \PY{n}{xy\PYZus{}array} \PY{o}{=} \PY{p}{[}\PY{n}{x\PYZus{}transformed}\PY{p}{,} \PY{n}{y\PYZus{}transformed}\PY{p}{]}
             
             
             \PY{k}{return} \PY{n}{xy\PYZus{}array}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{k}{def} \PY{n+nf}{measure}\PY{p}{(}\PY{n}{results\PYZus{}list}\PY{p}{)}\PY{p}{:}
             \PY{n}{length\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
             \PY{n}{image}\PY{p}{,} \PY{n}{image\PYZus{}meta}\PY{p}{,} \PY{n}{gt\PYZus{}class\PYZus{}id}\PY{p}{,} \PY{n}{gt\PYZus{}bbox}\PY{p}{,} \PY{n}{gt\PYZus{}mask} \PY{o}{=}\PYZbs{}
                 \PY{n}{modellib}\PY{o}{.}\PY{n}{load\PYZus{}image\PYZus{}gt}\PY{p}{(}\PY{n}{dataset}\PY{p}{,} \PY{n}{config}\PY{p}{,} \PY{n}{image\PYZus{}id}\PY{p}{,} \PY{n}{use\PYZus{}mini\PYZus{}mask}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
             
             \PY{k}{for} \PY{n}{item} \PY{o+ow}{in} \PY{n}{results\PYZus{}list}\PY{p}{:}
                 \PY{k}{if} \PY{n}{np}\PY{o}{.}\PY{n}{array\PYZus{}equal}\PY{p}{(}\PY{n}{results\PYZus{}list}\PY{p}{,} \PY{n}{detection\PYZus{}results}\PY{p}{)}\PY{p}{:}
                     \PY{n}{mask} \PY{o}{=} \PY{n}{item}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{masks}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{mask} \PY{o}{=} \PY{n}{item}
                     
                 \PY{n}{body} \PY{o}{=} \PY{n}{find\PYZus{}correct\PYZus{}mask}\PY{p}{(}\PY{n}{mask}\PY{p}{)} \PY{c+c1}{\PYZsh{}Ignore pectoral masks}
                 \PY{n}{xy\PYZus{}array} \PY{o}{=} \PY{n}{pca}\PY{p}{(}\PY{n}{body}\PY{p}{,} \PY{k+kc}{False}\PY{p}{)} \PY{c+c1}{\PYZsh{}PCA}
                 \PY{n}{x\PYZus{}transformed} \PY{o}{=} \PY{n}{xy\PYZus{}array}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                 \PY{n}{y\PYZus{}transformed} \PY{o}{=} \PY{n}{xy\PYZus{}array}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                 
                 \PY{c+c1}{\PYZsh{}Reassign max/min X values in case image was flipped during PCA}
         
                 \PY{n}{maxX} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{x\PYZus{}transformed}\PY{p}{)} \PY{c+c1}{\PYZsh{}rightX}
                 \PY{n}{minX} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{x\PYZus{}transformed}\PY{p}{)} \PY{c+c1}{\PYZsh{}leftX}
         
         \PY{c+c1}{\PYZsh{}Get corresonding Y values for leftX and rightX}
         
                 \PY{n}{maxX\PYZus{}index} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{x\PYZus{}transformed} \PY{o}{==} \PY{n}{maxX}\PY{p}{)} \PY{c+c1}{\PYZsh{}index of right\PYZhy{}most point}
                 \PY{n}{rightY} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}transformed}\PY{p}{[}\PY{n}{maxX\PYZus{}index}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}corresponding Y value}
         
         
                 \PY{n}{minX\PYZus{}index} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{x\PYZus{}transformed} \PY{o}{==} \PY{n}{minX}\PY{p}{)} \PY{c+c1}{\PYZsh{}index of left\PYZhy{}most point}
                 \PY{n}{leftY} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}transformed}\PY{p}{[}\PY{n}{minX\PYZus{}index}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}corresponding Y value}
                 
         \PY{c+c1}{\PYZsh{}Get points from leftX and rightX until it runs off the mask}
         
         \PY{c+c1}{\PYZsh{}Filter out points above straight line }
         \PY{c+c1}{\PYZsh{}Arbitrary lambda, might need to change later}
                 \PY{n}{lowEnough} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{filter}\PY{p}{(}\PY{k}{lambda} \PY{n}{y}\PY{p}{:} \PY{n}{y} \PY{o}{\PYZlt{}} \PY{p}{(}\PY{n}{leftY} \PY{o}{+} \PY{l+m+mf}{0.5}\PY{p}{)}\PY{p}{,} \PY{n}{y\PYZus{}transformed}\PY{p}{)}\PY{p}{)}
                 \PY{n}{yValues} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{filter}\PY{p}{(}\PY{k}{lambda} \PY{n}{y}\PY{p}{:} \PY{n}{y} \PY{o}{\PYZgt{}} \PY{p}{(}\PY{n}{leftY} \PY{o}{\PYZhy{}} \PY{l+m+mf}{0.5}\PY{p}{)}\PY{p}{,} \PY{n}{lowEnough}\PY{p}{)}\PY{p}{)} 
                 \PY{n}{yValues}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Get corresponding X values}
         \PY{c+c1}{\PYZsh{}List of appropriate indices}
                 \PY{n}{indices} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{k}{for} \PY{n}{point} \PY{o+ow}{in} \PY{n}{yValues}\PY{p}{:}
                     \PY{n}{index} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{y\PYZus{}transformed} \PY{o}{==} \PY{n}{point}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                     \PY{n}{indices}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{index}\PY{p}{)}
             
                 \PY{n}{xValues} \PY{o}{=} \PY{p}{[}\PY{p}{]} \PY{c+c1}{\PYZsh{}Corresponding X values}
                 \PY{k}{for} \PY{n}{index} \PY{o+ow}{in} \PY{n}{indices}\PY{p}{:}
                     \PY{n}{xValues}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{x\PYZus{}transformed}\PY{p}{[}\PY{n}{index}\PY{p}{]}\PY{p}{)} 
         
                 \PY{n}{xValues}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{p}{)}
         
         
                 \PY{n}{length} \PY{o}{=} \PY{n}{math}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{p}{(}\PY{n}{xValues}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{xValues}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{p}{(}\PY{n}{yValues}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{yValues}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
                 \PY{n}{length\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{length}\PY{p}{)}
                 \PY{k}{if} \PY{n}{np}\PY{o}{.}\PY{n}{array\PYZus{}equal}\PY{p}{(}\PY{n}{results\PYZus{}list}\PY{p}{,} \PY{n}{detection\PYZus{}results}\PY{p}{)}\PY{p}{:}
                     \PY{n}{item}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{length}\PY{p}{)}
                 
                 
               
             \PY{k}{return} \PY{n}{length\PYZus{}list}
             
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{k}{def} \PY{n+nf}{show\PYZus{}example}\PY{p}{(}\PY{n}{whale\PYZus{}list}\PY{p}{,} \PY{n}{index}\PY{p}{)}\PY{p}{:}
             
             \PY{n}{image\PYZus{}id} \PY{o}{=} \PY{n}{index}
             
             \PY{n}{image}\PY{p}{,} \PY{n}{image\PYZus{}meta}\PY{p}{,} \PY{n}{class\PYZus{}ids}\PY{p}{,} \PY{n}{bbox}\PY{p}{,} \PY{n}{mask} \PY{o}{=} \PY{n}{modellib}\PY{o}{.}\PY{n}{load\PYZus{}image\PYZus{}gt}\PY{p}{(}
                 \PY{n}{dataset}\PY{p}{,} \PY{n}{config}\PY{p}{,} \PY{n}{image\PYZus{}id}\PY{p}{,} \PY{n}{use\PYZus{}mini\PYZus{}mask}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
             \PY{n}{log}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{molded\PYZus{}image}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{image}\PY{p}{)}
             \PY{n}{log}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mask}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{mask}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mask.shape}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{mask}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
             
             \PY{n}{item} \PY{o}{=} \PY{n}{whale\PYZus{}list}\PY{p}{[}\PY{n}{index}\PY{p}{]}
             \PY{k}{if} \PY{n}{np}\PY{o}{.}\PY{n}{array\PYZus{}equal}\PY{p}{(}\PY{n}{whale\PYZus{}list}\PY{p}{,} \PY{n}{detection\PYZus{}results}\PY{p}{)}\PY{p}{:}
                 \PY{n}{mask} \PY{o}{=} \PY{n}{item}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{masks}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{mask} \PY{o}{=} \PY{n}{item} 
         
             \PY{n}{visualize}\PY{o}{.}\PY{n}{display\PYZus{}instances}\PY{p}{(}\PY{n}{image}\PY{p}{,} \PY{n}{bbox}\PY{p}{,} \PY{n}{mask}\PY{p}{,} \PY{n}{class\PYZus{}ids}\PY{p}{,} \PY{n}{dataset}\PY{o}{.}\PY{n}{class\PYZus{}names}\PY{p}{,} \PY{n}{show\PYZus{}bbox}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
             
         
             \PY{n}{length\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
             \PY{n}{image}\PY{p}{,} \PY{n}{image\PYZus{}meta}\PY{p}{,} \PY{n}{gt\PYZus{}class\PYZus{}id}\PY{p}{,} \PY{n}{gt\PYZus{}bbox}\PY{p}{,} \PY{n}{gt\PYZus{}mask} \PY{o}{=}\PYZbs{}
                 \PY{n}{modellib}\PY{o}{.}\PY{n}{load\PYZus{}image\PYZus{}gt}\PY{p}{(}\PY{n}{dataset}\PY{p}{,} \PY{n}{config}\PY{p}{,} \PY{n}{image\PYZus{}id}\PY{p}{,} \PY{n}{use\PYZus{}mini\PYZus{}mask}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
             
             \PY{n}{body} \PY{o}{=} \PY{n}{find\PYZus{}correct\PYZus{}mask}\PY{p}{(}\PY{n}{mask}\PY{p}{)}
             \PY{n}{xy\PYZus{}array} \PY{o}{=} \PY{n}{pca}\PY{p}{(}\PY{n}{body}\PY{p}{,} \PY{k+kc}{True}\PY{p}{)}
             \PY{n}{x\PYZus{}transformed} \PY{o}{=} \PY{n}{xy\PYZus{}array}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
             \PY{n}{y\PYZus{}transformed} \PY{o}{=} \PY{n}{xy\PYZus{}array}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                 \PY{c+c1}{\PYZsh{}Reassign max/min X values in case image was flipped}
         
             \PY{n}{maxX} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{x\PYZus{}transformed}\PY{p}{)} \PY{c+c1}{\PYZsh{}rightX}
             \PY{n}{minX} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{x\PYZus{}transformed}\PY{p}{)} \PY{c+c1}{\PYZsh{}leftX}
             
         \PY{c+c1}{\PYZsh{}Get corresonding Y values for leftX and rightX}
         
             \PY{n}{maxX\PYZus{}index} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{x\PYZus{}transformed} \PY{o}{==} \PY{n}{maxX}\PY{p}{)} \PY{c+c1}{\PYZsh{}index of right\PYZhy{}most point}
             \PY{n}{rightY} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}transformed}\PY{p}{[}\PY{n}{maxX\PYZus{}index}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}corresponding Y value}
         
         
             \PY{n}{minX\PYZus{}index} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{x\PYZus{}transformed} \PY{o}{==} \PY{n}{minX}\PY{p}{)} \PY{c+c1}{\PYZsh{}index of left\PYZhy{}most point}
             \PY{n}{leftY} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{p}{(}\PY{n}{y\PYZus{}transformed}\PY{p}{[}\PY{n}{minX\PYZus{}index}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}corresponding Y value}
                 
                 
         \PY{c+c1}{\PYZsh{}Get points from leftX and rightX until it runs off the mask}
         
         \PY{c+c1}{\PYZsh{}Filter out points above straight line }
         \PY{c+c1}{\PYZsh{}Arbitrary lambda, might need to change later}
             \PY{n}{lowEnough} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{filter}\PY{p}{(}\PY{k}{lambda} \PY{n}{y}\PY{p}{:} \PY{n}{y} \PY{o}{\PYZlt{}} \PY{p}{(}\PY{n}{leftY} \PY{o}{+} \PY{l+m+mf}{0.5}\PY{p}{)}\PY{p}{,} \PY{n}{y\PYZus{}transformed}\PY{p}{)}\PY{p}{)}
             \PY{n}{yValues} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{filter}\PY{p}{(}\PY{k}{lambda} \PY{n}{y}\PY{p}{:} \PY{n}{y} \PY{o}{\PYZgt{}} \PY{p}{(}\PY{n}{leftY} \PY{o}{\PYZhy{}} \PY{l+m+mf}{0.5}\PY{p}{)}\PY{p}{,} \PY{n}{lowEnough}\PY{p}{)}\PY{p}{)} 
             \PY{n}{yValues}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}Get corresponding X values}
         \PY{c+c1}{\PYZsh{}List of appropriate indices}
             \PY{n}{indices} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{point} \PY{o+ow}{in} \PY{n}{yValues}\PY{p}{:}
                 \PY{n}{index} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{y\PYZus{}transformed} \PY{o}{==} \PY{n}{point}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                 \PY{n}{indices}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{index}\PY{p}{)}
             
             \PY{n}{xValues} \PY{o}{=} \PY{p}{[}\PY{p}{]} \PY{c+c1}{\PYZsh{}Corresponding X values}
             \PY{k}{for} \PY{n}{index} \PY{o+ow}{in} \PY{n}{indices}\PY{p}{:}
                 \PY{n}{xValues}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{x\PYZus{}transformed}\PY{p}{[}\PY{n}{index}\PY{p}{]}\PY{p}{)} 
         
             \PY{n}{xValues}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{p}{)}
         
             \PY{n}{length} \PY{o}{=} \PY{n}{math}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{p}{(}\PY{n}{xValues}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{xValues}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{p}{(}\PY{n}{yValues}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{yValues}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{p}{)}
             \PY{n}{length\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{length}\PY{p}{)}
                 
             \PY{k}{if} \PY{n}{np}\PY{o}{.}\PY{n}{array\PYZus{}equal}\PY{p}{(}\PY{n}{whale\PYZus{}list}\PY{p}{,} \PY{n}{detection\PYZus{}results}\PY{p}{)}\PY{p}{:}
                 \PY{n}{item}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{length}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{}plt.plot(x\PYZus{}transformed, y\PYZus{}transformed, alpha = 0.5)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}transformed}\PY{p}{,} \PY{n}{y\PYZus{}transformed}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{zorder}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{} set axis limits}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{n}{minX} \PY{o}{\PYZhy{}} \PY{l+m+mi}{100}\PY{p}{,} \PY{n}{maxX} \PY{o}{+} \PY{l+m+mi}{100}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{[}\PY{n}{leftY} \PY{o}{\PYZhy{}} \PY{l+m+mi}{200}\PY{p}{,} \PY{n}{rightY} \PY{o}{+} \PY{l+m+mi}{200}\PY{p}{]}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{}Plot the first and last points from the list, use this for length}
             
             \PY{c+c1}{\PYZsh{}plt.scatter(xValues[0], yValues[0], zorder=10)}
             \PY{c+c1}{\PYZsh{}plt.scatter(xValues[\PYZhy{}1], yValues[\PYZhy{}1], zorder=10)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{xValues}\PY{p}{,} \PY{n}{yValues}\PY{p}{,} \PY{n}{zorder}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
             
             
         \PY{n}{show\PYZus{}example}\PY{p}{(}\PY{n}{mask\PYZus{}array}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
molded\_image             shape: (1024, 1024, 3)       min:    0.00000  max:  254.00000  uint8
mask                     shape: (1024, 1024, 3)       min:    0.00000  max:    1.00000  bool
mask.shape (1024, 1024, 3)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{n}{measure}\PY{p}{(}\PY{n}{detection\PYZus{}results}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}46}]:} [659.7249119691143,
          499.9859082391181,
          640.30382197778,
          642.023252025409,
          613.734388770382,
          608.2112600620023,
          782.2295007532966,
          537.3368871806866,
          558.3958517542266,
          528.1608115283063,
          593.473574781271,
          534.2975143423549,
          569.1273255515232,
          520.9846281773127,
          498.20673441021506,
          539.3717799216313,
          575.5638882344311]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{n}{manual\PYZus{}mask\PYZus{}lengths} \PY{o}{=} \PY{n}{measure}\PY{p}{(}\PY{n}{mask\PYZus{}array}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{n}{excel\PYZus{}measurements} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}excel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{NSF\PYZhy{}IOS\PYZus{}2017Measurements\PYZus{}kcb\PYZus{}updated\PYZus{}062018.xlsx}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{blue\PYZus{}measurements} \PY{o}{=} \PY{n}{excel\PYZus{}measurements}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{excel\PYZus{}measurements}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Whale}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{contains}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Bm}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{]}
         \PY{n}{blue\PYZus{}measurements} \PY{o}{=} \PY{n}{blue\PYZus{}measurements}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} imaged were downsized from 6000 as a max dimension to 1024 as a max dimension so pixels are 5x as large in meters}
         \PY{n}{pixel\PYZus{}size\PYZus{}factor} \PY{o}{=} \PY{l+m+mf}{6000.0} \PY{o}{/} \PY{l+m+mf}{1024.0}
         
         \PY{n}{measurements\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{blue\PYZus{}measurements}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Filename}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Auto\PYZus{}CNN\PYZus{}Measurements}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Manual\PYZus{}Mask\PYZus{}Measurements}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Manual\PYZus{}Standard\PYZus{}Measurements}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Estimated\PYZus{}Manual\PYZus{}Error}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}measurements\PYZus{}df.set\PYZus{}index(\PYZdq{}Filename\PYZdq{})}
         
         \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{blue\PYZus{}measurements}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{cnn\PYZus{}pixel\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{percent\PYZus{}error} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{manual\PYZus{}pixel\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
             
             \PY{k}{for} \PY{n}{whale} \PY{o+ow}{in} \PY{n}{detection\PYZus{}results}\PY{p}{:} \PY{c+c1}{\PYZsh{}CNN Masks}
                 \PY{k}{if} \PY{n}{whale}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Image}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     \PY{n}{cnn\PYZus{}pixel\PYZus{}count} \PY{o}{=} \PY{n}{whale}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}
                     
                 \PY{n}{adjusted\PYZus{}cnn\PYZus{}pixel\PYZus{}count} \PY{o}{=} \PY{n}{cnn\PYZus{}pixel\PYZus{}count} \PY{o}{*} \PY{n}{pixel\PYZus{}size\PYZus{}factor}
         
             \PY{c+c1}{\PYZsh{} TODO need to make this more robust, might not match the correct index at some point}
             \PY{n}{adjusted\PYZus{}manual\PYZus{}pixel\PYZus{}count} \PY{o}{=} \PY{n}{manual\PYZus{}mask\PYZus{}lengths}\PY{p}{[}\PY{n}{index}\PY{p}{]} \PY{o}{*} \PY{n}{pixel\PYZus{}size\PYZus{}factor} \PY{c+c1}{\PYZsh{}Manual Masks}
             
             \PY{n}{total\PYZus{}altitude} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Total Altitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
             \PY{n}{pixel\PYZus{}size} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Pixel size}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
             \PY{n}{focal\PYZus{}length} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Focal length (mm)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{c+c1}{\PYZsh{}always 5}
             
           
             
                 
             \PY{n}{measurements\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{measurements\PYZus{}df}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{index}\PY{p}{]}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Filename}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Image}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
             \PY{n}{measurements\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{measurements\PYZus{}df}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{index}\PY{p}{]}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Auto\PYZus{}CNN\PYZus{}Measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{adjusted\PYZus{}cnn\PYZus{}pixel\PYZus{}count} \PY{o}{*} \PY{n}{pixel\PYZus{}size}\PY{o}{/}\PY{n}{focal\PYZus{}length} \PY{o}{*} \PY{n}{total\PYZus{}altitude}
             \PY{n}{measurements\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{measurements\PYZus{}df}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{index}\PY{p}{]}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Manual\PYZus{}Mask\PYZus{}Measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{adjusted\PYZus{}manual\PYZus{}pixel\PYZus{}count} \PY{o}{*} \PY{n}{pixel\PYZus{}size}\PY{o}{/}\PY{n}{focal\PYZus{}length} \PY{o}{*} \PY{n}{total\PYZus{}altitude}
             \PY{n}{measurements\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{measurements\PYZus{}df}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{index}\PY{p}{]}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Manual\PYZus{}Standard\PYZus{}Measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Total Length (m)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
             
             \PY{n}{measurements\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{measurements\PYZus{}df}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{n}{index}\PY{p}{]}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Estimated\PYZus{}Manual\PYZus{}Error}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{row}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Estimated }\PY{l+s+si}{\PYZpc{} E}\PY{l+s+s2}{rror}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
             
             \PY{c+c1}{\PYZsh{} Percent error}
             \PY{c+c1}{\PYZsh{}percent\PYZus{}error = abs(measurements\PYZus{}df[\PYZdq{}Auto\PYZus{}CNN\PYZus{}Measurement\PYZdq{}][index] \PYZhy{} measurements\PYZus{}df[\PYZdq{}Manual\PYZus{}Standard\PYZus{}Measurement\PYZdq{}][index])/measurements\PYZus{}df[\PYZdq{}Manual\PYZus{}Standard\PYZus{}Measurement\PYZdq{}][index]*100}
             \PY{c+c1}{\PYZsh{}measurements\PYZus{}df.loc[measurements\PYZus{}df.index[index], \PYZdq{}Auto\PYZus{}Percent\PYZus{}Error\PYZdq{}] = percent\PYZus{}error}
         
         \PY{n}{measurements\PYZus{}df}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}52}]:}         Filename  Auto\_CNN\_Measurements  Manual\_Mask\_Measurements  \textbackslash{}
         0   DSC02689.JPG              21.804893                 22.374149   
         1   DSC03182.JPG              20.033111                 20.302168   
         2   DSC03206.JPG              21.853873                 22.044852   
         3   DSC03331.JPG              21.965600                 22.510574   
         4   DSC03665.JPG              21.527112                 21.810883   
         5   DSC03795.JPG              21.168680                 21.409063   
         6   DSC03868.JPG              22.123516                 22.435906   
         7   DSC03996.JPG              20.620096                 21.121444   
         8   DSC04067.JPG              22.537984                 22.818857   
         9   DSC04110.JPG              21.053401                 21.411126   
         10  DSC04216.JPG              23.458032                 24.055277   
         11  DSC04331.JPG              21.065048                 21.246789   
         12  DSC04475.JPG              21.709495                 24.173879   
         13  DSC04471.JPG              23.929808                 22.283291   
         14  DSC04596.JPG              22.324800                 21.371634   
         15  DSC04565.JPG              19.445489                 21.518875   
         16  DSC04578.JPG              21.111615                 22.869736   
         
             Manual\_Standard\_Measurements  Estimated\_Manual\_Error  
         0                      22.528405                  0.0004  
         1                      20.304210                  0.0074  
         2                      22.358987                  0.0074  
         3                      22.456202                  0.0074  
         4                      22.139630                  0.0004  
         5                      21.639458                  0.0004  
         6                      22.547801                  0.0004  
         7                      21.056910                  0.0074  
         8                      22.929705                  0.0074  
         9                      21.357748                  0.0074  
         10                     24.120341                  0.0074  
         11                     21.207847                  0.0074  
         12                     21.867586                  0.0074  
         13                     24.428231                  0.0074  
         14                     22.954157                  0.0074  
         15                     21.638016                  0.0074  
         16                     21.846274                  0.0074  
\end{Verbatim}
            
    \hypertarget{differences-in-conventional-measurements-vs-cnn-derived-measurements}{%
\paragraph{Differences in Conventional Measurements vs CNN Derived
Measurements}\label{differences-in-conventional-measurements-vs-cnn-derived-measurements}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{n}{std\PYZus{}auto\PYZus{}diff} \PY{o}{=} \PY{n}{measurements\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Manual\PYZus{}Standard\PYZus{}Measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{measurements\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Auto\PYZus{}CNN\PYZus{}Measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Max difference}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n+nb}{max}\PY{p}{(}\PY{n}{std\PYZus{}auto\PYZus{}diff}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Min difference}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n+nb}{min}\PY{p}{(}\PY{n}{std\PYZus{}auto\PYZus{}diff}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Avg difference}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{std\PYZus{}auto\PYZus{}diff}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Max difference 2.192527870275484
Min difference 0.14279880990366678
Avg difference 0.5675856019028773

    \end{Verbatim}

    \hypertarget{differences-in-conventional-measurements-vs-manual-mask-derived-measurements}{%
\paragraph{Differences in Conventional Measurements vs Manual Mask
Derived
Measurements}\label{differences-in-conventional-measurements-vs-manual-mask-derived-measurements}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{n}{std\PYZus{}man\PYZus{}diff} \PY{o}{=} \PY{n}{measurements\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Manual\PYZus{}Standard\PYZus{}Measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{measurements\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Manual\PYZus{}Mask\PYZus{}Measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Max difference}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n+nb}{max}\PY{p}{(}\PY{n}{std\PYZus{}man\PYZus{}diff}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Min difference}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n+nb}{min}\PY{p}{(}\PY{n}{std\PYZus{}man\PYZus{}diff}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Avg difference}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{std\PYZus{}man\PYZus{}diff}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Max difference 2.1449404539900208
Min difference -2.3062929091145214
Avg difference 0.0954710027597535

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{c+c1}{\PYZsh{} Histograms comparing lengths}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{)}
         
         \PY{n}{measurements\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Auto\PYZus{}CNN\PYZus{}Measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{stacked} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{cnn measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{CNN Masks vs. Real Measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{measurements\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Manual\PYZus{}Standard\PYZus{}Measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{stacked} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{r}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{conventional measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{)}
         \PY{n}{measurements\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Manual\PYZus{}Mask\PYZus{}Measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{stacked} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.9}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{manual mask measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{title}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Manual Masks vs. Real Measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{measurements\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Manual\PYZus{}Standard\PYZus{}Measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{stacked} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{g}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{conventional measurements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_24_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_24_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{n}{measurement\PYZus{}series} \PY{o}{=} \PY{n}{measurements\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{measurements\PYZus{}df}\PY{o}{.}\PY{n}{columns} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Auto\PYZus{}CNN\PYZus{}Measurements}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim(0,10)}
         \PY{n}{measurement\PYZus{}series}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{stacked}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{bins}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{measurement\PYZus{}series} \PY{o}{=} \PY{n}{measurements\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{measurements\PYZus{}df}\PY{o}{.}\PY{n}{columns} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Manual\PYZus{}Standard\PYZus{}Measurements}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim(0,10)}
         \PY{n}{measurement\PYZus{}series}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{stacked}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{bins}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<Figure size 432x288 with 0 Axes>
    \end{verbatim}

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    
    \begin{verbatim}
<Figure size 432x288 with 0 Axes>
    \end{verbatim}

    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{n}{show\PYZus{}example}\PY{p}{(}\PY{n}{mask\PYZus{}array}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
molded\_image             shape: (1024, 1024, 3)       min:    0.00000  max:  255.00000  uint8
mask                     shape: (1024, 1024, 3)       min:    0.00000  max:    1.00000  bool
mask.shape (1024, 1024, 3)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_26_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_26_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_26_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{n}{show\PYZus{}example}\PY{p}{(}\PY{n}{mask\PYZus{}array}\PY{p}{,} \PY{l+m+mi}{13}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
molded\_image             shape: (1024, 1024, 3)       min:    0.00000  max:  255.00000  uint8
mask                     shape: (1024, 1024, 1)       min:    0.00000  max:    1.00000  bool
mask.shape (1024, 1024, 1)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_27_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_27_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_27_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{show\PYZus{}example}\PY{p}{(}\PY{n}{detection\PYZus{}results}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
molded\_image             shape: (1024, 1024, 3)       min:    0.00000  max:  254.00000  uint8
mask                     shape: (1024, 1024, 3)       min:    0.00000  max:    1.00000  bool
mask.shape (1024, 1024, 3)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_29_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_29_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_29_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
